<div class="container">
  <div class="form-wrapper">

    <!-- Screen Name -->
    <div class="heading-section ng-star-inserted">
      <div>Budget Head Mapping</div>
    </div>

    <!-- Breadcrumb -->
    <nav aria-label="breadcrumb">
      <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="javascript:void(0);">Home</a></li>
        <li class="breadcrumb-item"><a href="javascript:void(0);">Payroll</a></li>
        <li class="breadcrumb-item active" aria-current="page">Budget Head Mapping</li>
      </ol>
    </nav>

    <form [formGroup]="budgetHeadMappingForm">

      <!--Starts Budget head mapping List -->
      <div class="panel-group">
        <div class="box box-primary">
          <div class="box-header">Budget Head Mapping</div>
          <div class="box-body">

            <div class="row">

              <div class="col-sm-3">
                <mat-form-field>
                  <input matInput formControlName="ddoNo" placeholder="DDO No.">
                </mat-form-field>
              </div>

              <div class="col-sm-3">
                <mat-form-field>
                  <input matInput formControlName="cardexNo" placeholder="Cardex No.">
                </mat-form-field>
              </div>

              <div class="col-sm-3">
                <mat-form-field>
                  <input matInput formControlName="officeName" placeholder=" Office Name">
                </mat-form-field>
              </div>

              <div class="col-sm-3">
                <mat-form-field>
                  <input matInput formControlName="district" placeholder="District">
                </mat-form-field>
              </div>


              <div class="col-sm-3">
                <mat-form-field class="full-width">
                  <mat-select formControlName="payrollType" placeholder="Payroll Type"
                    (selectionChange)="onPayrollType($event.value)" required>
                    <mat-option>
                      <ngx-mat-select-search [formControl]="payrollTypeCtrl" [placeholderLabel]="'Find Payroll Type...'"
                        [noEntriesFoundLabel]="'no matching Payroll Type found'" alphabetsSpaceOnly>
                      </ngx-mat-select-search>
                    </mat-option>
                    <mat-option *ngFor="let payrollName  of payrollTypelist | filterSelectInput:payrollTypeCtrl.value"
                      [value]="payrollName.value">
                      {{payrollName.viewValue}}
                    </mat-option>
                  </mat-select>
                  <div class="error-wrapper"
                    *ngIf="budgetHeadMappingForm.controls.payrollType.touched && (budgetHeadMappingForm.controls.payrollType.errors)">
                    <mat-error *ngIf="budgetHeadMappingForm.controls.payrollType.errors?.required">
                      {{errorMessages.PAYROLL_TYPE}}
                    </mat-error>
                  </div>
                </mat-form-field>
              </div>

              <div class="col-sm-3">
                <mat-form-field class="full-width">
                  <mat-select formControlName="financialYear" placeholder="Financial Year">
                    <mat-option>
                      <ngx-mat-select-search [formControl]="financialYearCtrl"
                        [placeholderLabel]="'Find Financial Year...'"
                        [noEntriesFoundLabel]="'no matching Financial Year found'" numbersHyphenOnly>
                      </ngx-mat-select-search>
                    </mat-option>
                    <mat-option>-- None --</mat-option>
                    <mat-option
                      *ngFor="let financialYearName  of finYearList | filterSelectInput:financialYearCtrl.value"
                      [value]="financialYearName.value">
                      {{financialYearName.viewValue}}
                    </mat-option>
                  </mat-select>
                </mat-form-field>
              </div>


              <!-- Pay Month -->

              <div class="col-sm-3">
                <mat-form-field class="full-width">
                  <mat-select formControlName="payMonth" placeholder="Pay Month" required>
                    <mat-option>
                      <ngx-mat-select-search [formControl]="payMonthCtrl" [placeholderLabel]="'Find Pay Month...'"
                        [noEntriesFoundLabel]="'no matching Pay Month found'" charactersOnly>
                      </ngx-mat-select-search>
                    </mat-option>
                    <mat-option *ngFor="let payMonthName  of payMonthList | filterSelectInput:payMonthCtrl.value"
                      [value]="payMonthName.value">
                      {{payMonthName.viewValue}}
                    </mat-option>
                  </mat-select>
                  <div class="error-wrapper"
                    *ngIf="budgetHeadMappingForm.controls.payMonth.touched && (budgetHeadMappingForm.controls.payMonth.errors)">
                    <mat-error *ngIf="budgetHeadMappingForm.controls.payMonth.errors?.required">
                      {{errorMessages.PAY_MONTH}}
                    </mat-error>
                  </div>
                </mat-form-field>
              </div>


            </div>
            <!-- Action Button Starts -->
            <div class="form-action-button">
              <button type="button" mat-raised-button color="primary" (click)="onChangeYearType()">Change
                Year\Type</button>
            </div>
            <!-- Action Button Ends -->
          </div>

          <div class="box-body">
            <div class="row">

              <div class="col-sm-3">
                <mat-form-field>
                  <mat-select formControlName="demand" placeholder="Demand" required>
                    <mat-option>
                      <ngx-mat-select-search [formControl]="demandCtrl" [placeholderLabel]="'Find Demand...'"
                        [noEntriesFoundLabel]="'no matching Demand found'" prBudgetHeadsOnly>
                      </ngx-mat-select-search>
                    </mat-option>
                    <mat-option *ngFor="let item of demandList | filterSelectInput : demandCtrl.value"
                      [value]="item.value" matTooltip="{{item.viewValue}}">
                      {{item.viewValue}}
                    </mat-option>
                  </mat-select>
                  <div class="error-wrapper"
                    *ngIf="budgetHeadMappingForm.controls.demand.touched && budgetHeadMappingForm.controls.demand.errors">
                    <mat-error *ngIf="budgetHeadMappingForm.controls.demand.errors.required">
                      {{errorMessages.DEMAND}}
                    </mat-error>
                  </div>
                </mat-form-field>
              </div>

              <div class="col-sm-3">
                <mat-form-field>
                  <mat-select formControlName="majorHead" placeholder="Major Head" required>
                    <mat-option>
                      <ngx-mat-select-search [formControl]="majorHeadCtrl" [placeholderLabel]="'Find Major Head...'"
                        [noEntriesFoundLabel]="'no matching Major Head found'" prBudgetHeadsOnly>
                      </ngx-mat-select-search>
                    </mat-option>
                    <mat-option *ngFor="let item of majorHeadList | filterSelectInput : majorHeadCtrl.value"
                      [value]="item.value" matTooltip="{{item.viewValue}}">
                      {{item.viewValue}}
                    </mat-option>
                  </mat-select>
                  <div class=" error-wrapper"
                    *ngIf="budgetHeadMappingForm.controls.majorHead.touched && budgetHeadMappingForm.controls.majorHead.errors">
                    <mat-error *ngIf="budgetHeadMappingForm.controls.majorHead.errors.required">
                      {{errorMessages.MAJOR_HEAD}}
                    </mat-error>
                  </div>
                </mat-form-field>
              </div>

              <div class="col-sm-3">
                <mat-form-field>
                  <mat-select formControlName="subMajorHead" placeholder="Sub Major Head" required>
                    <mat-option>
                      <ngx-mat-select-search [formControl]="subMajorHeadCtrl"
                        [placeholderLabel]="'Find Sub Major Head...'"
                        [noEntriesFoundLabel]="'no matching Sub Major Head found'" prBudgetHeadsOnly>
                      </ngx-mat-select-search>
                    </mat-option>
                    <mat-option *ngFor="let item of subMajorHeadList | filterSelectInput : subMajorHeadCtrl.value"
                      [value]="item.value" matTooltip="{{item.viewValue}}">
                      {{item.viewValue}}
                    </mat-option>
                  </mat-select>
                  <div class=" error-wrapper"
                    *ngIf="budgetHeadMappingForm.controls.subMajorHead.touched && budgetHeadMappingForm.controls.subMajorHead.errors">
                    <mat-error *ngIf="budgetHeadMappingForm.controls.subMajorHead.errors.required">
                      {{errorMessages.SUB_MAJOR_HEAD}}
                    </mat-error>
                  </div>
                </mat-form-field>
              </div>

              <div class="col-sm-3">
                <mat-form-field>
                  <mat-select formControlName="minorHead" placeholder="Minor Head" required>
                    <mat-option>
                      <ngx-mat-select-search [formControl]="minorHeadCtrl" [placeholderLabel]="'Find Minor Head...'"
                        [noEntriesFoundLabel]="'no matching Minor Head found'" prBudgetHeadsOnly>
                      </ngx-mat-select-search>
                    </mat-option>
                    <mat-option *ngFor="let item of minorHeadList | filterSelectInput : minorHeadCtrl.value"
                      [value]="item.value" matTooltip="{{item.viewValue}}">
                      {{item.viewValue}}
                    </mat-option>
                  </mat-select>
                  <div class=" error-wrapper"
                    *ngIf="budgetHeadMappingForm.controls.minorHead.touched && budgetHeadMappingForm.controls.minorHead.errors">
                    <mat-error *ngIf="budgetHeadMappingForm.controls.minorHead.errors.required">
                      {{errorMessages.MINOR_HEAD}}
                    </mat-error>
                  </div>
                </mat-form-field>
              </div>

              <div class="col-sm-3">
                <mat-form-field>
                  <mat-select formControlName="subHead" placeholder="Sub Head" required>
                    <mat-option>
                      <ngx-mat-select-search [formControl]="subHeadCtrl" [placeholderLabel]="'Find Sub Head...'"
                        [noEntriesFoundLabel]="'no matching Sub Head found'" prBudgetHeadsOnly>
                      </ngx-mat-select-search>
                    </mat-option>
                    <mat-option *ngFor="let item of subHeadList | filterSelectInput : subHeadCtrl.value"
                      [value]="item.value" matTooltip="{{item.viewValue}}">
                      {{item.viewValue}}
                    </mat-option>
                  </mat-select>
                  <div class=" error-wrapper"
                    *ngIf="budgetHeadMappingForm.controls.subHead.touched && budgetHeadMappingForm.controls.subHead.errors">
                    <mat-error *ngIf="budgetHeadMappingForm.controls.subHead.errors.required">
                      {{errorMessages.SUB_HEAD}}
                    </mat-error>
                  </div>
                </mat-form-field>
              </div>

              <div class="col-sm-3">
                <mat-form-field>
                  <mat-select formControlName="detailHead" placeholder="Detail Head" required>
                    <mat-option>
                      <ngx-mat-select-search [formControl]="detailHeadCtrl" [placeholderLabel]="'Find Detail Head...'"
                        [noEntriesFoundLabel]="'no matching Detail Head found'" prBudgetHeadsOnly>
                      </ngx-mat-select-search>
                    </mat-option>
                    <mat-option *ngFor="let item of detailHeadList | filterSelectInput : detailHeadCtrl.value"
                      [value]="item.value" matTooltip="{{item.viewValue}}">
                      {{item.viewValue}}
                    </mat-option>
                  </mat-select>
                  <div class=" error-wrapper"
                    *ngIf="budgetHeadMappingForm.controls.detailHead.touched && budgetHeadMappingForm.controls.detailHead.errors">
                    <mat-error *ngIf="budgetHeadMappingForm.controls.detailHead.errors.required">
                      {{errorMessages.DETAIL_HEAD}}
                    </mat-error>
                  </div>
                </mat-form-field>
              </div>

              <div class="col-sm-3">
                <mat-form-field class="full-width">
                  <mat-select formControlName="typeOfEstimation" placeholder="Type of Estimate" required>
                    <mat-option>
                      <ngx-mat-select-search [formControl]=" typeOfEstimationCTRL"
                        [placeholderLabel]="'Find Type of Estimate...'"
                        [noEntriesFoundLabel]="'No matching Type of Estimate Found'" prBudgetHeadsOnly>
                      </ngx-mat-select-search>
                    </mat-option>
                    <mat-option
                      *ngFor="let typeOfEstimationName of typeOfEstimationList | filterSelectInput:typeOfEstimationCTRL.value"
                      [value]="typeOfEstimationName.value" matTooltip="{{ typeOfEstimationName.viewValue }}">
                      {{typeOfEstimationName.viewValue}}
                    </mat-option>
                  </mat-select>
                  <div class=" error-wrapper"
                    *ngIf="budgetHeadMappingForm.controls.typeOfEstimation.touched && budgetHeadMappingForm.controls.typeOfEstimation.errors">
                    <mat-error *ngIf="budgetHeadMappingForm.controls.typeOfEstimation.errors.required">
                      {{errorMessages.TYPE_OF_ESTIMATE}}
                    </mat-error>
                  </div>
                </mat-form-field>
              </div>

              <div class="col-sm-3">
                <mat-form-field>
                  <mat-select formControlName="itemName" placeholder="Item Name / Work Name" required>
                    <mat-option>
                      <ngx-mat-select-search [formControl]="itemNameCTRL"
                        [placeholderLabel]="'Find Item Name / Work Name...'"
                        [noEntriesFoundLabel]="'No matching Item Name / Work Name Found'" prBudgetHeadsOnly>
                      </ngx-mat-select-search>
                    </mat-option>
                    <mat-option *ngFor="let item of itemNameList  | filterSelectInput:itemNameCTRL.value"
                      [value]="item.value">
                      {{item.viewValue}}
                    </mat-option>
                  </mat-select>
                  <div class=" error-wrapper"
                    *ngIf="budgetHeadMappingForm.controls.itemName.touched && budgetHeadMappingForm.controls.itemName.errors">
                    <mat-error *ngIf="budgetHeadMappingForm.controls.itemName.errors.required">
                      {{errorMessages.ITEM_OR_WORK_NAME}}
                    </mat-error>
                  </div>
                </mat-form-field>
              </div>

              <div class="col-sm-3">
                <mat-form-field>
                  <mat-select formControlName="objectClass" placeholder="Object Class" required>
                    <mat-option>
                      <ngx-mat-select-search [formControl]="objectClassCtrl" [placeholderLabel]="'Find Object Class...'"
                        [noEntriesFoundLabel]="'no matching Object Class found'" prBudgetHeadsOnly>
                      </ngx-mat-select-search>
                    </mat-option>
                    <mat-option *ngFor="let item of objectClassList | filterSelectInput : objectClassCtrl.value"
                      [value]="item.value" matTooltip="{{item.viewValue}}">
                      {{item.viewValue}}
                    </mat-option>
                  </mat-select>
                  <div class=" error-wrapper"
                    *ngIf="budgetHeadMappingForm.controls.objectClass.touched && budgetHeadMappingForm.controls.objectClass.errors">
                    <mat-error *ngIf="budgetHeadMappingForm.controls.objectClass.errors.required">
                      {{errorMessages.OBJECT_CLASS}}
                    </mat-error>
                  </div>
                </mat-form-field>
              </div>

              <div class="col-sm-3">
                <mat-form-field>
                  <mat-select formControlName="designation" placeholder="Designation" multiple required>
                    <mat-option>
                      <ngx-mat-select-search [formControl]="designationCtrl" [placeholderLabel]="'Find Designation...'"
                        [noEntriesFoundLabel]="'no matching Designation found'" numbersAlphabetsSpaceOnly>
                      </ngx-mat-select-search>
                    </mat-option>
                    <mat-option *ngFor="let item of designationList | filterSelectInput :designationCtrl.value"
                      [value]="item.value" matTooltip="{{item.viewValue}}">
                      {{item.viewValue}}
                    </mat-option>
                  </mat-select>
                  <div class=" error-wrapper"
                    *ngIf="budgetHeadMappingForm.controls.designation.touched && budgetHeadMappingForm.controls.designation.errors">
                    <mat-error *ngIf="budgetHeadMappingForm.controls.designation.errors.required">
                      {{errorMessages.DESIGNATION}}
                    </mat-error>
                  </div>
                </mat-form-field>
              </div>

            </div>
            <!--action button Starts  -->
            <div class="form-action-button">
              <button type="submit" mat-raised-button color="primary" (click)="search()" title="Search">
                <i class="material-icons" aria-hidden="true" title="Search">search</i>
                Search</button>
            </div>
            <!-- action button Ends -->
          </div>


        </div>
      </div>
      <!--Ends Budget head mapping List -->

      <!-- Budget head mapping - List view Starts -->
      <div class="panel-group">
        <div class="box box-primary">
          <div class="box-header">Budget Head Mapping - List view</div>
          <div class="box-body">


            <div class="mat-elevation-z8 mt-2 overflow-x-auto">
              <table mat-table [dataSource]="dataSource" aria-describedby="budgetHeadMappingTable">

                <ng-container matColumnDef="srNo">
                  <th mat-header-cell *matHeaderCellDef scope="row">Sr. No.</th>
                  <td mat-cell *matCellDef="let element" class="centerAlign">
                    {{element.srNo}}
                  </td>
                </ng-container>

                <ng-container matColumnDef="employeeNo">
                  <th mat-header-cell *matHeaderCellDef scope="row">Employee No.</th>
                  <td mat-cell *matCellDef="let element">
                    {{element.employeeNo}}
                  </td>
                </ng-container>

                <ng-container matColumnDef="employeeName">
                  <th mat-header-cell *matHeaderCellDef scope="row">Employee Name</th>
                  <td mat-cell *matCellDef="let element">
                    {{element.employeeName}}</td>
                </ng-container>

                <ng-container matColumnDef="designation">
                  <th mat-header-cell *matHeaderCellDef scope="row">Designation</th>
                  <td mat-cell *matCellDef="let element">
                    {{element.designation}} </td>
                </ng-container>

                <ng-container matColumnDef="employeeClass">
                  <th mat-header-cell *matHeaderCellDef scope="row">Employee Class</th>
                  <td mat-cell *matCellDef="let element">
                    {{element.employeeClass}} </td>
                </ng-container>

                <ng-container matColumnDef="employeeCat">
                  <th mat-header-cell *matHeaderCellDef scope="row">Employee Category</th>
                  <td mat-cell *matCellDef="let element">
                    {{element.employeeCat}} </td>
                </ng-container>

                <ng-container matColumnDef="budgetHead">
                  <th mat-header-cell *matHeaderCellDef scope="row">Budget Head</th>
                  <td mat-cell *matCellDef="let element">
                    {{element.budgetHead}} </td>
                </ng-container>

                <ng-container matColumnDef="action">
                  <th mat-header-cell *matHeaderCellDef scope="row">Action</th>
                  <td mat-cell *matCellDef="let element;let i=index">

                    <table class="iconTable" aria-describedby="actionBtn">
                      <tbody>
                        <tr>
                          <td width="30">
                            <div *ngIf="(element.employeeNo); then notHidden else isHidden">
                            </div>
                            <ng-template #isHidden>
                              <i class="material-icons plus add" aria-hidden="true" title="Add"
                                *ngIf="dataSource && dataSource.data && (i == dataSource.data.length - 1)"
                                style="color:lightgray;cursor:default;">add</i>
                            </ng-template>
                            <ng-template #notHidden>
                              <i class="material-icons plus add" aria-hidden="true" title="Add"
                                *ngIf="dataSource && dataSource.data && (i == dataSource.data.length - 1)"
                                (click)="add()">add</i>
                            </ng-template>
                          </td>
                          <td width="30">
                            <i class="material-icons plus delete" aria-hidden="true" title="Delete"
                              *ngIf="(dataSource && dataSource.data && dataSource.data.length > 1)&&!element.isSubmitted"
                              (click)="directiveObj.deleteRow(dataSource,i)">
                              delete
                            </i>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </td>
                </ng-container>

                <ng-container matColumnDef="noData">
                  <th mat-header-cell *matHeaderCellDef scope="row"></th>
                  <td mat-cell *matCellDef="let element;" [attr.colspan]="colCount" class="centerAlign">
                    {{element.noData}}
                  </td>
                </ng-container>

                <!-- Header Section Of table -->
                <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                <!-- Data Fetch From .TS File to table -->
                <tr mat-row *matRowDef="let row; let i = index;columns:displayedRows"></tr>

              </table>
            </div>
            <mat-paginator *ngIf="isSearch" [pageSizeOptions]="[5, 10, 20]" showFirstLastButtons>
            </mat-paginator>



          </div>
        </div>
      </div>
      <!-- Budget head mapping - List view Ends -->

      <!-- Action buttons Start -->
      <div class="form-action-button">
        <button mat-raised-button type="submit" class="green" (click)="onSubmit()" title="Submit">
          <i class="material-icons" title="Submit" aria-hidden="true">
            done
          </i> Submit
        </button>

        <button type="button" mat-raised-button color="accent" title="Reset" (click)="resetForm()">
          <i class="material-icons" title="Reset" aria-hidden="true">
            restore
          </i>
          Reset
        </button>
      </div>
      <!-- Action buttons End -->

    </form>

  </div>
</div>