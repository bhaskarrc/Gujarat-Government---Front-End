<div class="container">
  <div class="form-wrapper">

    <!-- heading-section -->
    <div class="heading-section ng-star-inserted">
      <div> Group Insurance Challan Generate</div>
      <div class="font-heading"><strong>Reference No:</strong> 19-20/GI/CHALENT/001</div>
      <div class="font-heading"><strong>Reference Date:</strong> {{ todayDate | date: 'dd-MMM-yyyy HH:mm'}}</div>
    </div>

    <!-- navigation -->
    <nav aria-label="breadcrumb">
      <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="javascript:void(0)">Home</a></li>
        <li class="breadcrumb-item " aria-current="page"><a href="javascript:void(0)">Group Insurance</a></li>
        <li class="breadcrumb-item active" aria-current="page"> Group Insurance Challan Generate</li>
      </ol>
    </nav>

    <div class="panel-group">

      <!-- challan details -->
      <div class="box box-primary">
        <div class="box-header">Challan Details</div>
        <div class="box-body">

          <!-- form start -->
          <form [formGroup]="challanEntryForm" (ngSubmit)="challanEntryFormData()">
            <div class="box box-primary">
              <div class="box-header">Office Details</div>
              <div class="box-body">
                <div class="row">

                  <!-- district -->
                  <div class="col-sm-3">
                    <mat-form-field class="full-width">
                      <mat-select formControlName="district" placeholder="District">
                        <mat-option>
                          <ngx-mat-select-search [formControl]="districtCtrl" [placeholderLabel]="'Find District...'"
                            [noEntriesFoundLabel]="'No matching District found'" alphabetsSpaceOnly>
                          </ngx-mat-select-search>
                        </mat-option>
                        <mat-option *ngFor="let item of districtList | filterSelectInput:districtCtrl.value"
                          [value]="item.value" matTooltip="{{ item.viewValue }}">
                          {{item.viewValue}}
                        </mat-option>
                      </mat-select>
                    </mat-form-field>
                  </div>

                  <!-- ddo no -->
                  <div class="col-md-3">
                    <mat-form-field>
                      <input matInput placeholder="DDO No." formControlName="ddoNo">
                    </mat-form-field>
                  </div>

                  <!-- cardex no -->
                  <div class="col-md-3">
                    <mat-form-field>
                      <input matInput placeholder="Cardex No." formControlName="cardexNo">
                    </mat-form-field>
                  </div>

                  <!-- ddo office name -->
                  <div class="col-md-3">
                    <mat-form-field>
                      <input matInput placeholder="DDO Office Name" formControlName="ddoOfficeName">
                    </mat-form-field>
                  </div>

                  <!-- challn no -->
                  <div class="col-md-3">
                    <mat-form-field>
                      <input matInput placeholder="Challan No." formControlName="challanNo" numbersOnly>
                    </mat-form-field>
                  </div>

                  <!-- challan date -->
                  <div class="col-sm-3">
                    <mat-form-field>
                      <input matInput formControlName="challanDate" [matDatepicker]="picker1"
                        placeholder="Challan Date">
                      <mat-datepicker-toggle matSuffix [for]="picker1"></mat-datepicker-toggle>
                      <mat-datepicker #picker1 [disabled]="false"></mat-datepicker>
                    </mat-form-field>
                  </div>

                </div>
              </div>
            </div>


            <!-- head structure details -->
            <div class="box box-primary">
              <div class="box-header">Head Structure Details</div>
              <div class="box-body">
                <div class="row">

                  <!-- major head -->
                  <div class="col-sm-3">
                    <mat-form-field class="full-width">
                      <mat-select formControlName="majorHead" #mjHead placeholder="Major Head"
                        (selectionChange)="selectMajorHead($event)">
                        <mat-option>
                          <ngx-mat-select-search [formControl]="majorHeadCtrl" [placeholderLabel]="'Find Major Head...'"
                            [noEntriesFoundLabel]="'No matching Major Head found'" alphabetsSpaceOnly>
                          </ngx-mat-select-search>
                        </mat-option>
                        <mat-option *ngFor="let item of majorHeadList | filterSelectInput:majorHeadCtrl.value"
                          [value]="item.value" matTooltip="{{item.viewValue}}">
                          {{item.viewValue}}
                        </mat-option>
                      </mat-select>
                    </mat-form-field>
                  </div>

                  <!-- sub major head -->
                  <div class="col-sm-3">
                    <mat-form-field class="full-width">
                      <mat-select formControlName="subMajorHead" placeholder="Sub Major Head"
                        (selectionChange)="selectSubMajorHead($event)">
                        <mat-option>
                          <ngx-mat-select-search [formControl]="subMajorHeadCtrl"
                            [placeholderLabel]="'Find Sub Major Head...'"
                            [noEntriesFoundLabel]="'No matching Sub Major Head found'" alphabetsSpaceOnly>
                          </ngx-mat-select-search>
                        </mat-option>
                        <mat-option *ngFor="let item of subMajorHeadList | filterSelectInput:subMajorHeadCtrl.value"
                          [value]="item.value" matTooltip="{{item.viewValue}}">
                          {{item.viewValue}}
                        </mat-option>
                      </mat-select>
                    </mat-form-field>
                  </div>

                  <!-- minor head -->
                  <div class="col-sm-3">
                    <mat-form-field class="full-width">
                      <mat-select formControlName="minorHead" placeholder="Minor Head"
                        (selectionChange)="selectMinorHead($event)">
                        <mat-option>
                          <ngx-mat-select-search [formControl]="minorHeadCtrl" [placeholderLabel]="'Find Minor Head...'"
                            [noEntriesFoundLabel]="'No matching Minor Head found'" alphabetsSpaceOnly>
                          </ngx-mat-select-search>
                        </mat-option>
                        <mat-option *ngFor="let item of minorHeadList | filterSelectInput:minorHeadCtrl.value"
                          [value]="item.value" matTooltip="{{item.viewValue}}">
                          {{item.viewValue}}
                        </mat-option>
                      </mat-select>
                    </mat-form-field>
                  </div>

                  <!-- sub head -->
                  <div class="col-sm-3">
                    <mat-form-field class="full-width">
                      <mat-select formControlName="subHead" placeholder="Sub Head"
                        (selectionChange)="selectSubHead($event)">
                        <mat-option>
                          <ngx-mat-select-search [formControl]="subHeadCtrl" [placeholderLabel]="'Find Sub Head...'"
                            [noEntriesFoundLabel]="'No matching Sub Head found'" alphabetsSpaceOnly>
                          </ngx-mat-select-search>
                        </mat-option>
                        <mat-option *ngFor="let item of subHeadList | filterSelectInput:subHeadCtrl.value"
                          [value]="item.value" matTooltip="{{item.viewValue}}">
                          {{item.viewValue}}
                        </mat-option>
                      </mat-select>
                    </mat-form-field>
                  </div>

                  <!--insurance ffund amount  -->
                  <div class="col-md-3"
                    *ngIf="(firstMajorHead && subMajorHead && firstMinorHead && firstSubHead) || ( secondMajorHead && subMajorHead && secondMinorHead && thirdSubHead)">
                    <mat-form-field>
                      <input matInput placeholder="Insurance Fund Amount" formControlName="insuranceFundAmount">
                    </mat-form-field>
                  </div>

                  <!-- saving fund amount -->
                  <div class="col-md-3"
                    *ngIf="(firstMajorHead && subMajorHead && firstMinorHead && secondSubHead) || ( secondMajorHead && subMajorHead && secondMinorHead && thirdSubHead)">
                    <mat-form-field>
                      <input matInput placeholder="Saving Fund Amount" formControlName="savingFundAmount">
                    </mat-form-field>
                  </div>

                </div>

                <!-- action button -->
                <div class="form-action-button">
                  <button type="submit" mat-raised-button color="primary" title="Add" (click)="add();">
                    <i class="material-icons" aria-hidden="true">add</i>
                    Add
                  </button>
                  <button type="reset" mat-raised-button color="accent" title="Reset" (click)="clearForm();">
                    <i class="material-icons" aria-hidden="true">
                      restore
                    </i>
                    Reset
                  </button>
                </div>
                <!-- action button  end-->

                <!-- table start -->
                <table mat-table [dataSource]="dataSource" width="100%" matSort>

                  <!-- Description Column -->
                  <ng-container matColumnDef="description">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header scope="row">Description</th>
                    <td mat-cell *matCellDef="let element; let i =index">
                      {{element.description}}
                    </td>
                    <td mat-footer-cell *matFooterCellDef></td>
                  </ng-container>

                  <!-- Head Structure Column -->
                  <ng-container matColumnDef="headStructure">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header scope="row">Head Structure</th>
                    <td mat-cell *matCellDef="let element; let i =index">
                      {{element.headStructure}}
                    </td>
                    <td mat-footer-cell *matFooterCellDef></td>
                  </ng-container>

                  <!-- total Column -->
                  <ng-container matColumnDef="total">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header scope="row">Total</th>
                    <td mat-cell *matCellDef="let element; let i =index" class="rightAlign">
                      {{element.total}}
                    </td>
                    <td mat-footer-cell *matFooterCellDef class="rightAlign">{{calculateTotal(i)}}</td>
                  </ng-container>

                  <ng-container matColumnDef="action">
                    <th mat-header-cell *matHeaderCellDef scope="row">Action</th>
                    <td mat-cell *matCellDef="let element;let i = index" style="text-align: center;"
                      class="action-btn-i centerAlign">
                      <i class="material-icons plus view-icon" aria-hidden="true" title="Delete"
                        (click)="deleteHeadStructureRow(i)">delete</i>
                    </td>
                    <td mat-footer-cell *matFooterCellDef></td>
                  </ng-container>

                  <!-- Header Section Of table -->
                  <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                  <!-- Data Fetch From .TS File to table -->
                  <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
                  <!-- Footer Section Of table -->
                  <tr mat-footer-row *matFooterRowDef="displayedColumns"></tr>
                </table>
                <!-- table end -->

              </div>
            </div>
          </form>
          <!-- form end -->

          <!-- employee details section -->
          <div class="box box-primary">
            <div class="box-header">Employee Details Section</div>
            <div class="box-body">
              <div class="mat-elevation-z8 mt-2">

                <!-- table start -->
                <table mat-table [dataSource]="employeeMasterDataSource" width="100%" aria-describedby="employeeDetails"
                  matSort>

                  <!-- Employee Number Column -->
                  <ng-container matColumnDef="employeeNumber">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header scope="row">Employee Number</th>
                    <td mat-cell *matCellDef="let element; let i =index">
                      <mat-form-field class="full-width">
                        <input matInput [(ngModel)]="element.employeeNumber" [value]="element.employeeNumber"
                          [ngModelOptions]="{standalone: true}" numbersAlphabetsOnly>
                        <mat-icon matSuffix class="searchIcon" (click)="openDialogEmployeeNumber(element,i)">
                          search</mat-icon>
                      </mat-form-field>
                    </td>
                  </ng-container>

                  <!-- Employee Name Column -->
                  <ng-container matColumnDef="employeeName">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header scope="row">Employee Name</th>
                    <td mat-cell *matCellDef="let element">
                      <mat-form-field>
                        <input matInput [(ngModel)]="element.employeeName" [value]="element.employeeName"
                          [ngModelOptions]="{standalone: true}" alphabetsSpaceOnly>
                      </mat-form-field>
                    </td>
                  </ng-container>

                  <!-- Insurance Fund Amount Column -->
                  <ng-container matColumnDef="phoneNo">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header scope="row">Phone No.</th>
                    <td mat-cell *matCellDef="let element">
                      <mat-form-field>
                        <input matInput [(ngModel)]="element.phoneNo" [value]="element.phoneNo"
                          [ngModelOptions]="{standalone: true}" numbersOnly maxlength="10">
                      </mat-form-field>
                    </td>
                  </ng-container>

                  <!-- Designagtion Column -->
                  <ng-container matColumnDef="designation">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header scope="row">Designation</th>
                    <td mat-cell *matCellDef="let element">
                      <mat-form-field class="full-width">
                        <mat-select [(ngModel)]="element.designation">
                          <mat-option>
                            <ngx-mat-select-search [formControl]="designationCtrl"
                              [placeholderLabel]="'Find Designation...'"
                              [noEntriesFoundLabel]="'No matching Designation found'" alphabetsSpaceOnly>
                            </ngx-mat-select-search>
                          </mat-option>
                          <mat-option
                            *ngFor="let designationName of designationList | filterSelectInput:designationCtrl.value"
                            [value]="designationName.value">
                            {{designationName.viewValue}}
                          </mat-option>
                        </mat-select>
                      </mat-form-field>
                    </td>
                  </ng-container>

                  <!-- From Month Column -->
                  <ng-container matColumnDef="fromMonth">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header scope="row">From Date</th>
                    <td mat-cell *matCellDef="let element">

                      <mat-form-field>
                        <input matInput [(ngModel)]="element.fromMonth" [matDatepicker]="fromDate" required>
                        <mat-datepicker-toggle matSuffix [for]="fromDate">
                        </mat-datepicker-toggle>
                        <mat-datepicker #fromDate></mat-datepicker>
                      </mat-form-field>

                    </td>
                  </ng-container>

                  <!-- To Month Column -->
                  <ng-container matColumnDef="toMonth">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header scope="row">End Date</th>
                    <td mat-cell *matCellDef="let element">
                      <mat-form-field>
                        <input matInput [(ngModel)]="element.toMonth" [matDatepicker]="toDate" required>
                        <mat-datepicker-toggle matSuffix [for]="toDate">
                        </mat-datepicker-toggle>
                        <mat-datepicker #toDate></mat-datepicker>
                      </mat-form-field>

                    </td>
                  </ng-container>

                  <!-- Insurance Fund Amount Column -->
                  <ng-container matColumnDef="insurancefundAmount">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header scope="row">Insurance Fund Amount</th>
                    <td mat-cell *matCellDef="let element" class="rightAlign">
                      <mat-form-field>
                        <input matInput class="rightAlign" [(ngModel)]="element.insurancefundAmount"
                          [value]="element.insurancefundAmount" [ngModelOptions]="{standalone: true}" numbersOnly>
                      </mat-form-field>
                    </td>
                  </ng-container>

                  <!-- Saving Fund Amount Column -->
                  <ng-container matColumnDef="savingFundAmount">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header scope="row">Saving Fund Amount</th>
                    <td mat-cell *matCellDef="let element" class="rightAlign">
                      <mat-form-field>
                        <input matInput class="rightAlign" [(ngModel)]="element.savingFundAmount"
                          [value]="element.savingFundAmount" [ngModelOptions]="{standalone: true}" numbersOnly>
                      </mat-form-field>
                    </td>
                  </ng-container>

                  <!-- Total Column -->
                  <ng-container matColumnDef="total">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header scope="row">Total</th>
                    <td mat-cell *matCellDef="let element" class="rightAlign">
                      {{calculateTotalAmountEmployeee(element) | number}}
                    </td>
                  </ng-container>

                  <!-- Action View/Edit/Delete Column -->
                  <ng-container matColumnDef="action">
                    <th mat-header-cell *matHeaderCellDef scope="row">Action</th>
                    <td mat-cell *matCellDef="let element;let i = index" style="text-align: center;"
                      class="action-btn-i centerAlign">
                      <a>
                        <i class="material-icons plus view-icon" aria-hidden="true" title="Add"
                          (click)="addRow(i)">add</i>
                      </a>
                      <a>
                        <i class="material-icons plus view-icon" aria-hidden="true" title="Delete"
                          (click)="deleteRow(i)">delete</i>
                      </a>
                    </td>
                  </ng-container>

                  <!-- Header Section Of table -->
                  <tr mat-header-row *matHeaderRowDef="employeeDetailsDataSourceColumn"></tr>
                  <!-- Data Fetch From .TS File to table -->
                  <tr mat-row *matRowDef="let row; columns: employeeDetailsDataSourceColumn;"></tr>
                </table>
                <!--table end  -->

                <!-- paginator -->
                <mat-paginator [pageSizeOptions]="[5, 10, 20]" showFirstLastButtons></mat-paginator>

              </div>
            </div>
          </div>
          <!-- employee details section end -->

          <!-- action button -->
          <div class="form-action-button">
            <button type="submit" mat-raised-button color="primary" title="Next" (click)="goToNext()">
              Save & Proceed
              <i class="material-icons" aria-hidden="true">
                chevron_right
              </i>
            </button>
          </div>
          <!-- action button end -->

        </div>
      </div>
      <!-- challan details end -->

      <!-- coomon action button -->
      <div class="form-action-button">

        <button mat-raised-button color="primary" title="Save as Draft">
          <i class="material-icons" aria-hidden="true">
            save
          </i>
          Save as Draft
        </button>

        <button mat-raised-button type="button" class="green" (click)="directiveObject.workflowDetails()"
          title="Submit">
          <i class="material-icons" aria-hidden="true">done</i> Submit
        </button>

        <button type="reset" mat-raised-button color="accent" title="Reset" (click)="resetForm()">
          <i class="material-icons" aria-hidden="true">
            restore
          </i>
          Reset
        </button>

        <button type="button" mat-raised-button color="warn" title="Listing" (click)="goToListing()">
          <i class="material-icons" aria-hidden="true">
            list
          </i>
          Listing
        </button>

        <button type="button" mat-raised-button class="btnClose" title="Close">
          <i class="material-icons" aria-hidden="true">
            close
          </i>
          Close
        </button>

      </div>
      <!-- coomon action button end -->

    </div>
  </div>
</div>