<div class="container">
  <div class="form-wrapper">
      <div class="heading-section ng-star-inserted">
          <div>Publications</div>
          <div class="font-heading">
            <b>Reference No:</b> 19-20/BUD/PUB/001</div>
        <div class="font-heading">
            <b>Reference Date:</b>24-Apr-2020 10:32</div>
         </div>

         <nav aria-label="breadcrumb">
           <ol class="breadcrumb">
             <li class="breadcrumb-item"><a href="#">Home</a></li>
             <li class="breadcrumb-item"><a href="#">Budget</a></li>
             <li class="breadcrumb-item active">Publications</li>
           </ol>
         </nav>
     
        <div #parentGrids>
            <mat-tab-group mat-stretch-tabs class="standing-est-tabing">
               <mat-tab label="Attachments">
                <form [formGroup]="publicationsForm" >
                    <div class="row">                            
                        <div class="col-sm-3">
                          <mat-form-field class="full-width">
                            <mat-select formControlName="finYear" #financialYrVal placeholder="Financial Year" required>
                                <mat-option>
                                    <ngx-mat-select-search [formControl]="finYearCtrl" [placeholderLabel]="'Find Financial Year...'" [noEntriesFoundLabel]="'no matching Financial Year found'">
                                    </ngx-mat-select-search>
                                </mat-option>
                                <mat-option *ngFor="let FY of finYear_list | filterSelectInput:finYearCtrl.value" [value]="FY.value">
                                    {{FY.viewValue}}
                                </mat-option>
                            </mat-select>
                            <mat-icon matSuffix class="searchIcon" (click)="onSearch()">
                              search
                            </mat-icon>
                            <div class="error-wrapper" *ngIf="publicationsForm.controls.finYear.touched && (publicationsForm.controls.finYear.errors)">
                              <mat-error *ngIf="publicationsForm.controls.finYear.errors.required">
                                  {{errorMessages.FIN_YEAR}}
                              </mat-error>
                          </div>
                        </mat-form-field>
                        </div>
                    </div>
                </form>

                <!-- <div *ngIf="financialYrVal.value=='1' && financialYrVal.value!=null  && searchVar"> -->
                <div>
                  <table mat-table [dataSource]="dataSourceBrowse" width="100%" aria-describedby="attachmentTable" id="browseTable">
                    <!-- Fin year -->
                    <ng-container matColumnDef="position">
                        <th mat-header-cell *matHeaderCellDef scope="row">Sr. No.</th>
                        <td mat-cell *matCellDef="let item; let i = index" class="centerAlign">
                        {{ i + 1 }}
                        </td>
                    </ng-container>
                    
                    <ng-container matColumnDef="attachmentType">
                          <th mat-header-cell *matHeaderCellDef scope="row">Attachment Type</th>
                          <td mat-cell *matCellDef="let item;let i = index;">
                              <mat-select placeholder="Attachment Type" #singleSelect1 required [(ngModel)]="item.dropDown">
                                  <mat-option>
                                      <ngx-mat-select-search [formControl]="attachmentTypeCtrl" [placeholderLabel]="'Find Attachment Type...'" [noEntriesFoundLabel]="'no matching Attachment Type found'">
                                      </ngx-mat-select-search>
                                  </mat-option>
                                  <mat-option *ngFor="let attachment of filteredAttachmentType | async" #selected
                                  matTooltip="{{attachment.viewValue}}" [value]="attachment.value">
                                      {{attachment.viewValue}}                                      
                                  </mat-option>
                              </mat-select>
                          </td>
                      </ng-container>
                      <ng-container matColumnDef="fileName">
                          <th mat-header-cell *matHeaderCellDef scope="row">File name</th>
                          <td mat-cell *matCellDef="let item">
                              <mat-form-field floatLabel="never">
                                  <textarea matInput rows="2" maxlength="200" [value]="item.name"
                                   [(ngModel)]="item.name" [ngModelOptions]="{standalone: true}"></textarea>
                              </mat-form-field>
                          </td>
                      </ng-container>
                      <ng-container matColumnDef="browse">
                          <th mat-header-cell *matHeaderCellDef scope="row">
                              <div style="display: flex; align-items: center; justify-content: center">
                                  <div style="display: inline-flex">Browse</div>
                                  <div class="info-container">
                                      <i aria-hidden="true" class="material-icons info-tooltip">
                                          info
                                      </i>
                                      <span class="info-tooltip-content">
                                          - File size should be less than 20MB<br>
                                          - File type supported are: 'pdf'
                                      </span>
                                  </div>
                              </div>
                          </th>
                          <td mat-cell *matCellDef="let i = index" class="centerAlign">
                              <button type="button" (click)="openFileSelector(i)" class="btn-browse">Browse
                                  Files</button>
                          </td>
                      </ng-container>
                      <ng-container matColumnDef="uploadedFileName">
                          <th mat-header-cell *matHeaderCellDef scope="row">Uploaded file name</th>
                          <td mat-cell *matCellDef="let item">
                              <span *ngIf="item.file && item.file.name">{{item.file.name}}
                                  <i class="material-icons closesmall">
                                      close
                                  </i>
                              </span>
                          </td>
                      </ng-container>
                      <ng-container matColumnDef="uploadedBy">
                          <th mat-header-cell *matHeaderCellDef scope="row">Uploaded By</th>
                          <td mat-cell *matCellDef="let item">
                              <mat-label>Office 1 </mat-label>
                          </td>
                      </ng-container>
                      <ng-container matColumnDef="action">
                          <th mat-header-cell *matHeaderCellDef scope="row">Action</th>
                          <td mat-cell *matCellDef="let item; let i = index">
                              <table class="iconTable">
                                  <tbody>
                                      <tr>
                                          <td width="30">
                                            <i class="material-icons plus edit-icon" title="Edit">
                                                edit
                                            </i>
                                          </td>
                                          <td width="30">
                                              <i aria-hidden="true" class="material-icons plus" title="view">
                                                  visibility
                                              </i>
                                          </td>
                                          <td width="30">
                                              <i aria-hidden="true" class="material-icons plus" *ngIf="dataSourceBrowse && dataSourceBrowse.data && (i == dataSourceBrowse.data.length - 1)" (click)="addBrowse()">
                                                  add
                                              </i>
                                          </td>
                                          <td width="30">
                                              <i aria-hidden="true" class="material-icons plus delete" *ngIf="dataSourceBrowse && dataSourceBrowse.data && dataSourceBrowse.data.length > 1" (click)="deleteBrowse(i)">
                                                  delete
                                              </i>
                                          </td>
                                      </tr>
                                  </tbody>
                              </table>
                          </td>
                      </ng-container>
                      <tr mat-header-row *matHeaderRowDef="displayedBrowseColumns"></tr>
                      <tr mat-row *matRowDef="let row; columns: displayedBrowseColumns;"></tr>
                  </table>
                  <input type="file" id="fileBrowse" style="visibility: hidden;" (change)="onFileSelection($event)" />
                  <div class="legend mt-3">
                    1. Total File size should be under 20MB<br> 2. File type supported are: 'pdf'.
                  </div>
                </div>

                <!-- Action Buttons -->
                <div class="form-action-button">
                    <button mat-raised-button type="submit" class="green"><i aria-hidden="true" class="material-icons">
                            done
                        </i> Submit</button>
                  <button type="button" mat-raised-button (click)="gotoListing()" color="warn">
                    <i class="material-icons" aria-hidden="true" title="Listing">
                      list
                    </i>
                    Listing
                  </button>
                  <button type="button" class="btnClose" mat-raised-button>
                    <i class="material-icons" aria-hidden="true" title="Budget
                      dashboard">
                      close
                    </i>
                    Close
                  </button>
                </div>
               </mat-tab>
            </mat-tab-group>
      </div>
  </div>
</div>