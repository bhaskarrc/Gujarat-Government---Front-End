<div class="container">
  <div class="form-wrapper">

    <div class="heading-section ng-star-inserted">
      <div>  List of Work-in-Progress Consolidation</div>
    </div>

    <nav aria-label="breadcrumb">
      <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="#">Home</a></li>
        <li class="breadcrumb-item"><a href="#">Budget</a></li>
        <li class="breadcrumb-item active" aria-current="page"> List of Work-in-Progress Consolidation</li>
      </ol>
    </nav>

    <mat-accordion class="search-accordian">
      <mat-expansion-panel [expanded]="true">
        <mat-expansion-panel-header>
          <div class="heading-section">
            Search
          </div>
        </mat-expansion-panel-header>
        <div class="form-datatable-list">
          <form class="col-sm-12" [formGroup]="searchListForm">
            <div class="row">
              <div class="col-sm-3">
                <mat-form-field class="full-width">
                  <mat-select formControlName="finYear" placeholder="Financial
                    Year" #singleSelect1>
                    <mat-option>
                      <ngx-mat-select-search [formControl]="finYearCtrl" [placeholderLabel]="'Find Financial Year...'"
                        [noEntriesFoundLabel]="'no
                        matching Financial Year found'">
                      </ngx-mat-select-search>
                    </mat-option>

                    <mat-option *ngFor="let FY of
                      filteredFinYear | async" [value]="FY.value">
                      {{FY.viewValue}}
                    </mat-option>
                  </mat-select>
                </mat-form-field>
              </div>
              <div class="col-sm-3">
                <mat-form-field class="full-width">
                  <mat-select formControlName="majorHeadCode" placeholder="Major
                    Head">
                    <mat-option>
                      <ngx-mat-select-search [formControl]="majorHeadCodeCtrl" [placeholderLabel]="'Find Major Head...'"
                        [noEntriesFoundLabel]="'no
                        matching Major Head found'">
                      </ngx-mat-select-search>
                    </mat-option>
                    <mat-option *ngFor="let majorHead of
                      filteredMajorlist |
                      filterSelectInput:majorHeadCodeCtrl.value" [value]="majorHead.value">
                      {{majorHead.viewValue}}
                    </mat-option>
                  </mat-select>
                </mat-form-field>
              </div>

              <div class="col-sm-3">
                <mat-form-field class="full-width">
                  <mat-select formControlName="revenuecapital" placeholder="Revenue / Capital">
                    <mat-option *ngFor="let revenu of reveList" [value]="revenu.value">
                      {{revenu.viewValue}}
                    </mat-option>
                  </mat-select>
                </mat-form-field>
              </div>
              <div class="col-sm-3">
                <mat-form-field class="full-width">
                  <input matInput type="text" formControlName="refNO" placeholder="Reference No.">
                </mat-form-field>
              </div>
              <div class="col-sm-3">
                <mat-form-field class="full-width">
                  <mat-select formControlName="statusd" placeholder="Status" (selectionChange)="ontoken($event)">
                    <mat-option *ngFor="let statu of statuslist" [value]="statu.value">
                      {{statu.viewValue}}
                    </mat-option>
                  </mat-select>
                </mat-form-field>
              </div>
              <div class="col-sm-3" *ngIf="isTokentable">
                <mat-form-field class="full-width">
                  <input matInput type="text" formControlName="approvedBy" placeholder="{{rangeTypeValue}} By">
                </mat-form-field>
              </div>
              <div class="col-sm-3" *ngIf="isTokentable">
                <mat-form-field>
                  <input matInput [matDatepicker]="approveDatepickerfr" formControlName="apporRefDate"
                    placeholder="{{rangeTypeValue}} On From Date">
                  <mat-datepicker-toggle matSuffix [for]="approveDatepickerfr"></mat-datepicker-toggle>
                  <mat-datepicker #approveDatepickerfr></mat-datepicker>
                </mat-form-field>
              </div>
              <div class="col-sm-3" *ngIf="isTokentable">
                <mat-form-field>
                  <input matInput [matDatepicker]="approvefDatepickerto" formControlName="apporReftDate"
                    placeholder="{{rangeTypeValue}} On To Date">
                  <mat-datepicker-toggle matSuffix [for]="approvefDatepickerto"></mat-datepicker-toggle>
                  <mat-datepicker #approvefDatepickerto></mat-datepicker>
                </mat-form-field>
              </div>
              <div class="col-sm-3">
                <mat-form-field class="full-width">
                  <mat-select formControlName="recevie" placeholder="Received
                    From / Sent To" (selectionChange)="onrecevietoken($event)">
                    <mat-option *ngFor="let recevies of receivelist" [value]="recevies.value">
                      {{recevies.viewValue}}
                    </mat-option>
                  </mat-select>
                </mat-form-field>
              </div>
              <div class="col-sm-3" *ngIf="isToken">
                <mat-form-field class="full-width">
                  <input matInput type="text" formControlName="receiveddata" placeholder="{{receiveValue}}">
                </mat-form-field>
              </div>

              <div class="col-sm-3">
                <mat-form-field>
                  <input matInput [matDatepicker]="refDatepickerfr" formControlName="frRefDate"
                    placeholder="Received On /Sent On From Date">
                  <mat-datepicker-toggle matSuffix [for]="refDatepickerfr"></mat-datepicker-toggle>
                  <mat-datepicker #refDatepickerfr></mat-datepicker>
                </mat-form-field>
              </div>

              <div class="col-sm-3">
                <mat-form-field>
                  <input matInput [matDatepicker]="refDatepickerto" formControlName="frRefDate"
                    placeholder="Received On /Sent On To Date">
                  <mat-datepicker-toggle matSuffix [for]="refDatepickerto"></mat-datepicker-toggle>
                  <mat-datepicker #refDatepickerto></mat-datepicker>
                </mat-form-field>
              </div>
              <div class="col-sm-3">
                <mat-form-field>
                  <input matInput [matDatepicker]="Datepickerfrom" formControlName="datepickerfrom"
                    placeholder="Reference From Date">
                  <mat-datepicker-toggle matSuffix [for]="Datepickerfrom"></mat-datepicker-toggle>
                  <mat-datepicker #Datepickerfrom></mat-datepicker>
                </mat-form-field>
              </div>
              <div class="col-sm-3">
                <mat-form-field>
                  <input matInput [matDatepicker]="Datepickerto" formControlName="datepickerfrom"
                    placeholder="Reference To Date">
                  <mat-datepicker-toggle matSuffix [for]="Datepickerto"></mat-datepicker-toggle>
                  <mat-datepicker #Datepickerto></mat-datepicker>
                </mat-form-field>
              </div>


            </div>
          </form>
        </div>

        <div class="row displayBlock form-action-button">
          <div class="centerAlign">
            <button type="submit" mat-raised-button color="primary">
              <i class="material-icons" aria-hidden="true">search</i>
              Search
            </button>
            <button type="reset" mat-raised-button color="accent" (click)="resetForm()">
              <i class="material-icons" aria-hidden="true">
                restore
              </i>
              Reset
            </button>
          </div>
        </div>
      </mat-expansion-panel>
    </mat-accordion>

    <div class="mat-elevation-z8 mt-2">
      <table mat-table aria-describedby="wipConsolidateList" [dataSource]="dataSource" width="100%" matSort>
        <ng-container matColumnDef="position">
          <th mat-header-cell *matHeaderCellDef scope="row" [ngStyle]="{'display': 'none'}">
            srno. </th>
          <td mat-cell *matCellDef="let element; let i= index;" class="centerAlign">
            {{ i + 1 }} </td>
        </ng-container>
        <ng-container matColumnDef="head1">
          <th mat-header-cell *matHeaderCellDef scope="row" [attr.rowspan]="2">Sr No.</th>
        </ng-container>

        <ng-container matColumnDef="budgetHead">
          <th mat-header-cell *matHeaderCellDef scope="row" mat-sort-header [ngStyle]="{'display': 'none'}">Financial
            Year</th>
          <td mat-cell *matCellDef="let element"> {{element.budgetHead}}
          </td>
        </ng-container>
        <ng-container matColumnDef="head2">
          <th mat-header-cell *matHeaderCellDef scope="row" [attr.rowspan]="2">Budget Head
          </th>
        </ng-container>

        <ng-container matColumnDef="objHead">
          <th mat-header-cell *matHeaderCellDef scope="row" mat-sort-header [ngStyle]="{'display': 'none'}">Object Head</th>
          <td mat-cell *matCellDef="let element"><a matTooltip="{{element.tooltip2}}"> {{element.objHead}}</a>
          </td>
        </ng-container>
        <ng-container matColumnDef="oHead">
          <th mat-header-cell *matHeaderCellDef scope="row" [attr.rowspan]="2">Object Head
          </th>
        </ng-container>

        <ng-container matColumnDef="noDDOs">
          <th mat-header-cell *matHeaderCellDef scope="row" mat-sort-header [ngStyle]="{'display': 'none'}"> </th>
          <td mat-cell *matCellDef="let element">
            <a class="hyper-link" (click)="loadDDOList(element)">{{element.noDDOs}}</a>
            <!-- <a (click)="loadDDOList(item)">{{element.noOfDDO}}</a> -->
          </td>
        </ng-container>
        <ng-container matColumnDef="head3">
          <th mat-header-cell *matHeaderCellDef scope="row" [attr.rowspan]="2">No. of DDOs
          </th>
        </ng-container>
        <!-- city -->
        <ng-container matColumnDef="ddo">
          <th mat-header-cell *matHeaderCellDef scope="row"> DDO </th>
          <td mat-cell *matCellDef="let element" class="rightAlign"> {{element.ddo  | number : '1.2-2'}} </td>
        </ng-container>

        <!-- city -->
        <ng-container matColumnDef="cohod">
          <th mat-header-cell *matHeaderCellDef scope="row"> CO/HoD
          </th>
          <td mat-cell *matCellDef="let element" class="rightAlign"> {{element.cohod  | number : '1.2-2'}} </td>
        </ng-container>
        <!-- city -->
        <ng-container matColumnDef="ad">
          <th mat-header-cell *matHeaderCellDef scope="row"> AD </th>
          <td mat-cell *matCellDef="let element" class="rightAlign"> {{element.ad  | number : '1.2-2'}} </td>
        </ng-container>

        <!-- city -->
        <ng-container matColumnDef="fd">
          <th mat-header-cell *matHeaderCellDef scope="row"> FD
          </th>
          <td mat-cell *matCellDef="let element" class="rightAlign"> {{element.cohod  | number : '1.2-2'}} </td>
        </ng-container>

        <ng-container matColumnDef="head4">
          <th mat-header-cell *matHeaderCellDef scope="row" [attr.colspan]="4">Consolidated
            Proposed Amount

          </th>
        </ng-container>
        <ng-container matColumnDef="refNo">
          <th mat-header-cell *matHeaderCellDef scope="row" mat-sort-header [ngStyle]="{'display': 'none'}">Reference
            No. </th>
          <td mat-cell *matCellDef="let element" class="leftAlign">
            {{element.refNo}} </td>
        </ng-container>
        <ng-container matColumnDef="head6">
          <th mat-header-cell *matHeaderCellDef scope="row" [attr.rowspan]="2">Reference
            No.
          </th>
        </ng-container>
        <ng-container matColumnDef="receivedOnFrom">
          <th mat-header-cell *matHeaderCellDef scope="row" mat-sort-header [ngStyle]="{'display': 'none'}">Received
            From
            Received On
          </th>
          <td mat-cell *matCellDef="let element" class="leftAlign">
            {{element.receivedOnFrom}} </td>
        </ng-container>
        <ng-container matColumnDef="head7">
          <th mat-header-cell *matHeaderCellDef scope="row" [attr.rowspan]="2">Received
            From
            Received On
          </th>
        </ng-container>
        <ng-container matColumnDef="sentToOn">
          <th mat-header-cell *matHeaderCellDef scope="row" mat-sort-header [ngStyle]="{'display': 'none'}">Sent
            To
            Sent On

          </th>
          <td mat-cell *matCellDef="let element" class="leftAlign">
            {{element.sentToOn}} </td>
        </ng-container>
        <ng-container matColumnDef="head8">
          <th mat-header-cell *matHeaderCellDef scope="row" [attr.rowspan]="2">Sent
            To
            Sent On
          </th>
        </ng-container>
        <ng-container matColumnDef="lyingWith">
          <th mat-header-cell *matHeaderCellDef scope="row" mat-sort-header [ngStyle]="{'display': 'none'}">
            Lying With

          </th>
          <td mat-cell *matCellDef="let element" class="leftAlign">
            {{element.lyingWith}} </td>
        </ng-container>
        <ng-container matColumnDef="head9">
          <th mat-header-cell *matHeaderCellDef scope="row" [attr.rowspan]="2">Lying With
          </th>
        </ng-container>

        <ng-container matColumnDef="status">
          <th mat-header-cell *matHeaderCellDef scope="row" mat-sort-header [ngStyle]="{'display': 'none'}">
            Status
          </th>
          <td mat-cell *matCellDef="let element" class="leftAlign">
            <a matTooltip="{{element.tooltip}}"> {{element.status}} </a></td>
        </ng-container>
        <ng-container matColumnDef="head10">
          <th mat-header-cell *matHeaderCellDef scope="row" [attr.rowspan]="2">Status
          </th>
        </ng-container>

        <ng-container matColumnDef="action">
          <th mat-header-cell *matHeaderCellDef scope="row" [ngStyle]="{'display': 'none'}">
            Action</th>
          <td mat-cell *matCellDef="let element;let i= index;" class="action-btn-i centerAlign">
            <a class="delete-icon" *ngIf="element.status=='-'"><i aria-hidden="true" class="material-icons rotate-180 plus delete" (click)="consolidate()" title="Consolidate">
                device_hub
              </i></a>
            <a *ngIf="element.status=='Draft' || element.status=='Pending'"><i aria-hidden="true" class="material-icons plus edit-icon" (click)="consolidatePage()" aria-hidden="true" title="Edit"> edit </i></a>
            <a *ngIf="element.status=='Draft' || element.status=='Pending' || element.status=='Rejected' || element.status=='Approved'"><i aria-hidden="true" class="material-icons plus view-icon" title="Detail View" (click)="consolidateView()">
              remove_red_eye
            </i></a>
            <a *ngIf="element.status=='Draft' || element.status=='Pending' || element.status=='Rejected' || element.status=='Approved'"><i class="material-icons plus" (click)="showHistoryDialog()" aria-hidden="true" title="History Detail">receipt</i></a>
            
            <!-- <a class="delete-icon"><i aria-hidden="true" class="material-icons plus delete"
                title="delete">delete_forever</i></a> -->
          </td>
        </ng-container>
        <ng-container matColumnDef="head11">
          <th mat-header-cell *matHeaderCellDef scope="row" [attr.rowspan]="2">Action</th>
        </ng-container>
        <tr mat-header-row
          *matHeaderRowDef="['head1','head2','oHead','head3','head4','head6','head7','head8','head9','head10','head11']"></tr>
        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
      </table>
      <mat-paginator [pageSizeOptions]="[5, 10, 20]" showFirstLastButtons></mat-paginator>
    </div>
  </div>
</div>
