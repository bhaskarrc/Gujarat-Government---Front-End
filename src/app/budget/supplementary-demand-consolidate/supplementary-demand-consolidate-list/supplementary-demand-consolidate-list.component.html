<div class="container">
    <div class="form-wrapper">
        <div class="heading-section ng-star-inserted">
            <div>Supplementary Demand Consolidation List</div>
        </div>

        <nav aria-label="breadcrumb">
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="#">Home</a></li>
                <li class="breadcrumb-item"><a href="#">Budget</a></li>
                <li class="breadcrumb-item active" aria-current="page">Supplementary Demand Consolidation List</li>
            </ol>
        </nav>

        <!-- Search Section Starts -->
        <mat-accordion class="search-accordian">
            <mat-expansion-panel [expanded]="true">
                <mat-expansion-panel-header>
                    <div class="heading-section">
                        Search
                    </div>
                </mat-expansion-panel-header>
                <div>
                    <form class="col-sm-12" [formGroup]="searchListForm" (ngSubmit)="saveEstimate()">
                        <div class="row">
                            <div class="col-sm-3">
                                <mat-form-field class="full-width">
                                    <mat-select formControlName="finYear" placeholder="Financial Year" #singleSelect1>
                                        <mat-option>
                                            <ngx-mat-select-search [formControl]="finYearCtrl"
                                                [placeholderLabel]="'Find Financial Year...'"
                                                [noEntriesFoundLabel]="'no matching Financial Year found'">
                                            </ngx-mat-select-search>
                                        </mat-option>
                                        <mat-option>-- None --</mat-option>

                                        <mat-option *ngFor="let FY of filteredFinYear | async" [value]="FY.value">
                                            {{FY.viewValue}}
                                        </mat-option>
                                    </mat-select>
                                </mat-form-field>
                            </div>
                            <div class="col-sm-3">
                                <mat-form-field class="full-width">
                                    <mat-select formControlName="departmentCode" placeholder="Department"
                                        #singleSelect1>
                                        <mat-option>
                                            <ngx-mat-select-search [formControl]="departmentCodeCtrl"
                                                [placeholderLabel]="'Find Department...'"
                                                [noEntriesFoundLabel]="'no matching Department found'">
                                            </ngx-mat-select-search>
                                        </mat-option>
                                        <mat-option>-- None --</mat-option>

                                        <mat-option *ngFor="let department of filteredDepartmentCode | async"
                                            [value]="department.value" matTooltip="{{department.viewValue}}">
                                            {{department.viewValue}}
                                        </mat-option>
                                    </mat-select>
                                </mat-form-field>
                            </div>

                            <div class="col-sm-3">
                                <mat-form-field class="full-width">
                                    <mat-select formControlName="demandCode" placeholder="Demand" #singleSelect1>
                                        <mat-option>
                                            <ngx-mat-select-search [formControl]="demandCodeCtrl"
                                                [placeholderLabel]="'Find Demand Code...'"
                                                [noEntriesFoundLabel]="'no matching Demand Code found'">
                                            </ngx-mat-select-search>
                                        </mat-option>
                                        <mat-option>-- None --</mat-option>
                                        <mat-option matTooltip="{{demand.viewValue}}"
                                            *ngFor="let demand of filteredDemandCode | async" 
                                            matTooltip="{{demand.viewValue}}" [value]="demand.value">
                                            {{demand.viewValue}}
                                        </mat-option>
                                    </mat-select>
                                </mat-form-field>
                            </div>
                            <div class="col-sm-3">
                                <mat-form-field class="full-width">
                                    <mat-select formControlName="revenueCapital" placeholder="Revenue/Capital"
                                        #singleSelect1>
                                        <mat-option>
                                            <ngx-mat-select-search [formControl]="revenueCapitalCtrl"
                                                [placeholderLabel]="'Find Revenue/Capital...'"
                                                [noEntriesFoundLabel]="'no matching Major Head found'">
                                            </ngx-mat-select-search>
                                        </mat-option>
                                        <mat-option>-- None --</mat-option>
                                        <mat-option *ngFor="let revenue of filteredRevenueCapital | async"
                                            [value]="revenue.value">
                                            {{revenue.viewValue}}
                                        </mat-option>
                                    </mat-select>
                                </mat-form-field>
                            </div>
                            <div class="col-sm-3">
                                <mat-form-field class="full-width">
                                    <input matInput type="text" formControlName="refNo" placeholder="Reference No.">
                                </mat-form-field>
                            </div>

                            <div class="col-sm-3">
                                <mat-form-field>
                                    <input matInput [matDatepicker]="Datepickerfrom" formControlName="fromDate"
                                        placeholder="Reference From Date">
                                    <mat-datepicker-toggle matSuffix [for]="Datepickerfrom"></mat-datepicker-toggle>
                                    <mat-datepicker #Datepickerfrom></mat-datepicker>
                                </mat-form-field>
                            </div>

                            <div class="col-sm-3">
                                <mat-form-field>
                                    <input matInput [matDatepicker]="Datepickerto" formControlName="toDate"
                                        placeholder="Reference To Date">
                                    <mat-datepicker-toggle matSuffix [for]="Datepickerto"></mat-datepicker-toggle>
                                    <mat-datepicker #Datepickerto></mat-datepicker>
                                </mat-form-field>
                            </div>
                            <div class="col-sm-3">
                                <mat-form-field class="full-width">
                                    <mat-select formControlName="chargedVoted" placeholder="Charged/Voted"
                                        #singleSelect1>
                                        <mat-option>
                                            <ngx-mat-select-search [formControl]="chargedVotedCtrl"
                                                [placeholderLabel]="'Find Charged/Voted...'"
                                                [noEntriesFoundLabel]="'no matching Sub Major Head found'">
                                            </ngx-mat-select-search>
                                        </mat-option>
                                        <mat-option>-- None --</mat-option>
                                        <mat-option *ngFor="let charged of filteredChargedVoted | async"
                                            [value]="charged.value">
                                            {{charged.viewValue}}
                                        </mat-option>
                                    </mat-select>
                                </mat-form-field>
                            </div>
                            <div class="col-sm-3">
                                <mat-form-field class="full-width">
                                    <input matInput type="text" formControlName="lyingWithBox" placeholder="Lying With">
                                </mat-form-field>
                            </div>
                            <div class="col-sm-3">
                                <mat-form-field class="full-width">
                                    <mat-select formControlName="status" placeholder="Status">
                                        <mat-option>
                                            <ngx-mat-select-search [formControl]="statusCtrl"
                                                [placeholderLabel]="'Find Status...'"
                                                [noEntriesFoundLabel]="'no matching Status found'">
                                            </ngx-mat-select-search>
                                        </mat-option>
                                        <mat-option>-- None --</mat-option>
                                        <mat-option *ngFor="let va of statuslist | filterSelectInput:statusCtrl.value"
                                            [value]="va.value">
                                            {{va.viewValue}}
                                        </mat-option>
                                    </mat-select>
                                </mat-form-field>
                            </div>
                            <div class="col-sm-3">
                                <mat-form-field class="full-width">
                                    <mat-select formControlName="wstatus" placeholder="Workflow Status">
                                        <mat-option>
                                            <ngx-mat-select-search [formControl]="wstatusCtrl"
                                                [placeholderLabel]="'Find Workflow Status...'"
                                                [noEntriesFoundLabel]="'no matching Workflow Status found'">
                                            </ngx-mat-select-search>
                                        </mat-option>
                                        <mat-option>-- None --</mat-option>
                                        <mat-option *ngFor="let va of wstatuslist | filterSelectInput:wstatusCtrl.value"
                                            [value]="va.value">
                                            {{va.viewValue}}
                                        </mat-option>
                                    </mat-select>
                                </mat-form-field>
                            </div>
                        </div>
                    </form>
                </div>
                <!-- Action Buttons -->
                <div class="form-action-button">
                    <div class="centerAlign">
                        <button type="submit" mat-raised-button color="primary">
                            <i class="material-icons" aria-hidden="true">search</i>
                            Search
                        </button>
                        <button type="reset" mat-raised-button color="accent" (click)="clearForm();">
                            <i class="material-icons" aria-hidden="true">
                                restore
                            </i>
                            Reset
                        </button>
                    </div>

                </div>
            </mat-expansion-panel>
        </mat-accordion>
        <!-- Search Section Ends -->

        <div class="mat-elevation-z8 mt-2 customresponsive">
            <!-- Table Section Starts-->
            <table mat-table [dataSource]="dataSource" width="100%" matSort>
                <!-- Sr. No. -->
                <ng-container matColumnDef="position">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>Sr. No.</th>
                    <td mat-cell *matCellDef="let element; let i = index" [attr.rowspan]="getRowSpan('position', i)"
                        [style.display]="getRowSpan('position', i) ? '' : 'none'" class="centerAlign">
                        {{element.position}} </td>
                </ng-container>

                <!-- Reference No. -->
                <ng-container matColumnDef="refNo">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>Reference No.</th>
                    <td mat-cell *matCellDef="let element; let i = index" [attr.rowspan]="getRowSpan('position', i)"
                        [style.display]="getRowSpan('position', i) ? '' : 'none'"> {{element.refNo}} </td>
                </ng-container>

                <!-- Reference Date -->
                <ng-container matColumnDef="refDate">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>Reference Date</th>
                    <td mat-cell *matCellDef="let element; let i = index" [attr.rowspan]="getRowSpan('position', i)"
                        [style.display]="getRowSpan('position', i) ? '' : 'none'"> {{element.refDate}} </td>
                </ng-container>

                <!-- Demand  -->
                <ng-container matColumnDef="demand">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>Demand </th>
                    <td mat-cell *matCellDef="let element; let i = index" [attr.rowspan]="getRowSpan('demand', i)"
                        [style.display]="getRowSpan('demand', i) ? '' : 'none'">
                        <span *ngIf="element.position!=2">{{element.demand}}</span>
                        <span *ngIf="element.position==2">
                            <a [routerLink]="'../supplementary-demand-consolidate-view'">{{element.demand}}</a>
                        </span>
                    </td>
                </ng-container>

                <!-- Revenue/Capital  -->
                <ng-container matColumnDef="revenueCapital">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>Revenue/Capital </th>
                    <td mat-cell *matCellDef="let element; let i = index"
                        [attr.rowspan]="getRowSpan('revenueCapital', i)"
                        [style.display]="getRowSpan('revenueCapital', i) ? '' : 'none'"> {{element.revenueCapital}}
                    </td>
                </ng-container>

                <!-- Voted/Charged  -->
                <ng-container matColumnDef="votedCharged">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>Voted/Charged </th>
                    <td mat-cell *matCellDef="let element"> {{element.votedCharged}} </td>
                </ng-container>

                <!-- Received From  -->
                <ng-container matColumnDef="recFrom">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>Received From</th>
                    <td mat-cell *matCellDef="let element; let i = index" [attr.rowspan]="getRowSpan('position', i)"
                        [style.display]="getRowSpan('position', i) ? '' : 'none'"> {{element.recFrom}} </td>
                </ng-container>

                <!-- Received Date  -->
                <ng-container matColumnDef="recDate">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>Received Date</th>
                    <td mat-cell *matCellDef="let element; let i = index" [attr.rowspan]="getRowSpan('position', i)"
                        [style.display]="getRowSpan('position', i) ? '' : 'none'"> {{element.recDate}} </td>
                </ng-container>

                <!-- Sent To  -->
                <ng-container matColumnDef="sentTo">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>Sent To</th>
                    <td mat-cell *matCellDef="let element; let i = index" [attr.rowspan]="getRowSpan('position', i)"
                        [style.display]="getRowSpan('position', i) ? '' : 'none'"> {{element.sentTo}} </td>
                </ng-container>

                <!-- Sent Date  -->
                <ng-container matColumnDef="sentDate">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>Sent Date</th>
                    <td mat-cell *matCellDef="let element; let i = index" [attr.rowspan]="getRowSpan('position', i)"
                        [style.display]="getRowSpan('position', i) ? '' : 'none'"> {{element.sentDate}} </td>
                </ng-container>

                <!-- Lying with  -->
                <ng-container matColumnDef="lyingWith">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>Lying with</th>
                    <td mat-cell *matCellDef="let element; let i = index" [attr.rowspan]="getRowSpan('position', i)"
                        [style.display]="getRowSpan('position', i) ? '' : 'none'"> {{element.lyingWith}} </td>
                </ng-container>

                <!-- Status  -->
                <ng-container matColumnDef="status">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>Status</th>
                    <td mat-cell *matCellDef="let element; let i = index" [attr.rowspan]="getRowSpan('position', i)"
                        [style.display]="getRowSpan('position', i) ? '' : 'none'"> {{element.status}} </td>
                </ng-container>

                <!-- Workflow status  -->
                <ng-container matColumnDef="wstatus">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>Workflow status</th>
                    <td mat-cell *matCellDef="let element; let i = index" [attr.rowspan]="getRowSpan('position', i)"
                        [style.display]="getRowSpan('position', i) ? '' : 'none'"> {{element.wstatus}} </td>
                </ng-container>

                <!-- Excess Demand/Savings  -->
                <ng-container matColumnDef="excess">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>Excess Demand/Savings </th>
                    <td mat-cell *matCellDef="let element" class="rightAlign"> {{element.excess}} </td>
                </ng-container>

                <!-- Action  -->
                <ng-container matColumnDef="action">
                    <th mat-header-cell *matHeaderCellDef scope="row"> Action </th>
                    <td mat-cell *matCellDef="let element; let i = index" [attr.rowspan]="getRowSpan('position', i)"
                        [style.display]="getRowSpan('position', i) ? '' : 'none'" class="text-center">

                        <table class="iconTable" aria-describedby="actionBtn">
                            <tbody>
                                <tr>
                                    <td width="30">
                                        <a [routerLink]="'../supplementary-demand-consolidate'"><i
                                                class="material-icons plus edit-icon mr-2" title="Edit"> edit </i></a>
                                    </td>
                                    <td width="30">
                                        <a [routerLink]="'../supplementary-demand-consolidate-view'"><i
                                                class="material-icons plus view-icon mr-2"
                                                title="View">remove_red_eye</i></a>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                        <!-- <a class="delete-icon" ><i class="material-icons plus delete" title="delete">delete</i></a> -->
                    </td>
                </ng-container>

                <!-- Header Section Of table -->
                <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                <!-- Data Fetch From .TS File to table -->
                <tr mat-row *matRowDef="let row; let i = index;columns: displayedColumns;"
                    [ngClass]="{'completed': (row.position==1 || row.position==2 || row.position==6 || row.position==7),'incomplete': (row.position!=1 || row.position!=2 || row.position!=6 || row.position!=7)}">
                </tr>
            </table>
            <!-- Table Section Ends-->

            <mat-paginator [pageSizeOptions]="[8, 16, 32]" showFirstLastButtons></mat-paginator>
        </div>

    </div>
</div>