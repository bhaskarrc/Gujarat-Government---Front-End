<div class="form-wrapper">
    <div class="pannel-group">
        <div class="heading-section ng-star-inserted">
            <div> Online Final Payment Case - DPPF</div>
            <div class="font-heading"><strong>Reference Number:</strong> 19-20/GPF/POFPC/001</div>
            <div class="font-heading"><strong>Reference Date:</strong> {{ todayDate | date: 'dd-MMM-yyyy HH:mm'}}
            </div>
        </div>
        <nav aria-label="breadcrumb">
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="#">Home</a></li>
                <li class="breadcrumb-item"><a href="#">Worklist</a></li>
                <li class="breadcrumb-item active" aria-current="page"> Online Final Payment Case -DPPF </li>
            </ol>
        </nav>
        <!-- Online Final Payment Case -DPPF -->
        <mat-tab-group mat-stretch-tabs [selectedIndex]="selectedIndexMain"
            (selectedIndexChange)="getTabIndexMain($event)">
            <mat-tab>
                <ng-template mat-tab-label>
                    Online Final Payment Case -DPPF
                </ng-template>
                <form [formGroup]='inwardDialogFormGroup'>
                    <div class=" box box-primary">
                        <div class="box-header">
                            Online Final Payment Case
                        </div>

                        <div class="box-body">
                            <div class="row">



                                <div class="col-sm-6 col-md-3">
                                    <mat-form-field class="full-width">
                                        <input matInput placeholder="Employee No." formControlName='employeeNo'
                                            decimalLimitTwoOnly (change)="enterEmployeeNo()">
                                    </mat-form-field>
                                </div>

                                <div class="col-sm-6 col-md-3">
                                    <mat-form-field class="full-width">
                                        <input matInput placeholder="GPF  No." formControlName='gpfNo' required>
                                        <div class="error-wrapper"
                                            *ngIf=" inwardDialogFormGroup.controls.gpfNo.touched &&inwardDialogFormGroup.controls.gpfNo.errors">
                                            <mat-error *ngIf="inwardDialogFormGroup.controls.gpfNo.errors.required">
                                                {{ errorMessage.GPF_NUMBER }}
                                            </mat-error>
                                        </div>
                                    </mat-form-field>
                                </div>


                                <div class="col-sm-6 col-md-3">
                                    <mat-form-field class="full-width">
                                        <input matInput placeholder="First Name" formControlName='firstName'
                                            alphabetsSpaceOnly>
                                    </mat-form-field>
                                </div>


                                <div class="col-sm-6 col-md-3">
                                    <mat-form-field class="full-width">
                                        <input matInput placeholder="Middle Name" formControlName='middleName'
                                            alphabetsSpaceOnly>
                                    </mat-form-field>
                                </div>


                                <div class="col-sm-6 col-md-3">
                                    <mat-form-field class="full-width">
                                        <input matInput placeholder="Last Name" formControlName='lastName'
                                            alphabetsSpaceOnly>
                                    </mat-form-field>
                                </div>

                                <div class="col-sm-6 col-md-3">
                                    <mat-form-field class="full-width">
                                        <input matInput placeholder="Major Head" formControlName='majorHead'
                                            decimalLimitTwoOnly maxlength="4">
                                    </mat-form-field>
                                </div>


                                <div class="col-sm-6 col-md-3">
                                    <mat-form-field class="full-width">
                                        <input matInput placeholder="Staus On Date" formControlName='statusOnDate'
                                            alphabetsSpaceOnly>
                                    </mat-form-field>
                                </div>

                                <div class="col-sm-3">
                                    <mat-form-field class="full-width">
                                        <mat-select formControlName="district" placeholder="District">
                                            <mat-option>
                                                <ngx-mat-select-search [formControl]="typeOfDistrictCtrl"
                                                    [placeholderLabel]="'Find District...'"
                                                    [noEntriesFoundLabel]="'no matching District found'">
                                                </ngx-mat-select-search>
                                            </mat-option>
                                            <mat-option>-- None --</mat-option>
                                            <mat-option *ngFor="
                          let CE of classTypeOfDistrict
                            | filterSelectInput: typeOfDistrictCtrl.value
                        " [value]="CE.value">
                                                {{ CE.viewValue }}
                                            </mat-option>
                                        </mat-select>

                                    </mat-form-field>
                                </div>


                                <div class="col-sm-3">
                                    <mat-form-field class="full-width">
                                        <mat-select formControlName="treasuryPao" placeholder="Treasury/PAO">
                                            <mat-option>
                                                <ngx-mat-select-search [formControl]="typeOfTreasuryPAOCtrl"
                                                    [placeholderLabel]="'Find Treasury/PAO...'"
                                                    [noEntriesFoundLabel]="'no matching Treasury/PAO found'">
                                                </ngx-mat-select-search>
                                            </mat-option>
                                            <mat-option>-- None --</mat-option>
                                            <mat-option *ngFor="
                          let CE of classTypeOfTreasuryPAO
                            | filterSelectInput: typeOfDistrictCtrl.value
                        " [value]="CE.value" matTooltip="{{ CE.viewValue }}">
                                                {{ CE.viewValue }}
                                            </mat-option>
                                        </mat-select>

                                    </mat-form-field>
                                </div>

                                <div class="col-sm-3">
                                    <mat-form-field class="full-width">
                                        <mat-select formControlName="subTreasury" placeholder="Sub Treasury">
                                            <mat-option>
                                                <ngx-mat-select-search [formControl]="typeOfSubTreasuryCtrl"
                                                    [placeholderLabel]="'Find Sub Treasury...'"
                                                    [noEntriesFoundLabel]="'no matching Sub Treasury found'">
                                                </ngx-mat-select-search>
                                            </mat-option>
                                            <mat-option>-- None --</mat-option>
                                            <mat-option *ngFor="
                          let CE of classTypeOfSubTreasury
                            | filterSelectInput: typeOfSubTreasuryCtrl.value
                        " [value]="CE.value">
                                                {{ CE.viewValue }}
                                            </mat-option>
                                        </mat-select>

                                    </mat-form-field>
                                </div>

                                <div class="col-sm-6 col-md-3">
                                    <mat-form-field class="full-width">
                                        <input matInput placeholder="Cardex No" formControlName='cardexNo'
                                            decimalLimitTwoOnly maxlength="3" readonly>
                                    </mat-form-field>
                                </div>

                                <div class="col-sm-6 col-md-3">
                                    <mat-form-field class="full-width">
                                        <input matInput placeholder="DDO Name" formControlName='ddoName' readonly>
                                    </mat-form-field>
                                </div>

                                <div class="col-sm-6 col-md-3">
                                    <mat-form-field class="full-width">
                                        <input matInput placeholder="Basic Pay" formControlName='basicPay'
                                            decimalLimitTwoOnly required>
                                        <div class="error-wrapper"
                                            *ngIf=" inwardDialogFormGroup.controls.basicPay.touched &&inwardDialogFormGroup.controls.basicPay.errors">
                                            <mat-error *ngIf="inwardDialogFormGroup.controls.basicPay.errors.required">
                                                {{ errorMessage.BASIC_PAY }}
                                            </mat-error>
                                        </div>

                                    </mat-form-field>
                                </div>

                                <div class="col-sm-6 col-md-3">
                                    <mat-form-field class="full-width">
                                        <input matInput placeholder="Letter No" formControlName='letterNo'
                                            decimalLimitTwoOnly>
                                    </mat-form-field>
                                </div>

                                <div class="col-sm-6 col-md-3">
                                    <mat-form-field>
                                        <mat-label>Letter Date</mat-label>
                                        <input matInput [matDatepicker]="letterDatePicker" formControlName="letterDate"
                                            dateOnly />
                                        <mat-datepicker-toggle matSuffix [for]="letterDatePicker">
                                        </mat-datepicker-toggle>
                                        <mat-datepicker #letterDatePicker></mat-datepicker>

                                    </mat-form-field>
                                </div>

                                <div class="col-sm-6 col-md-3">
                                    <mat-form-field class="full-width">
                                        <input matInput placeholder="ACR NO." formControlName='acrNo'
                                            decimalLimitTwoOnly>
                                    </mat-form-field>
                                </div>

                                <div class="col-sm-6 col-md-3">
                                    <mat-form-field class="full-width">
                                        <input matInput placeholder="Final Payment Authority No"
                                            formControlName='finalPaymentAuthorityNo' decimalLimitTwoOnly>
                                    </mat-form-field>
                                </div>



                                <div class="col-sm-6 col-md-3">
                                    <mat-form-field class="full-width">
                                        <mat-label>Account Close Details (Openings)</mat-label>
                                        <input matInput formControlName='accountCloseDetailOpening'>
                                        <i matSuffix class="material-icons plus view-icon" title="View"
                                            aria-hidden="true" (click)="openAccountDetailOpen()">remove_red_eye
                                        </i>
                                    </mat-form-field>
                                </div>

                                <div class="col-sm-6 col-md-3">
                                    <mat-form-field class="full-width">
                                        <mat-label>Account Close Details</mat-label>
                                        <input matInput formControlName='accountCloseDetails'>
                                        <i matSuffix class="material-icons plus view-icon" title="View"
                                            aria-hidden="true" (click)="openAccountDetail()">remove_red_eye
                                        </i>
                                    </mat-form-field>
                                </div>

                                <div class="col-sm-3">
                                    <mat-form-field class="full-width">
                                        <mat-select formControlName="reopenClose" placeholder="Reopen/Close">
                                            <mat-option>
                                                <ngx-mat-select-search [formControl]="typeOfReopenCloseCtrl"
                                                    [placeholderLabel]="'Find Reopen/Close...'"
                                                    [noEntriesFoundLabel]="'no matching Reopen/Close found'">
                                                </ngx-mat-select-search>
                                            </mat-option>
                                            <mat-option>-- None --</mat-option>
                                            <mat-option *ngFor="
                                      let CE of classTypeOfReopenClose
                                        | filterSelectInput: typeOfReopenCloseCtrl.value
                                    " [value]="CE.value">
                                                {{ CE.viewValue }}
                                            </mat-option>
                                        </mat-select>

                                    </mat-form-field>
                                </div>

                                <div class="col-sm-3">
                                    <mat-form-field class="full-width">
                                        <mat-select formControlName="reason" placeholder="Reason" required>
                                            <mat-option>
                                                <ngx-mat-select-search [formControl]="typeOfReasonCtrl"
                                                    [placeholderLabel]="'Find Reason...'"
                                                    [noEntriesFoundLabel]="'no matching Reason found'">
                                                </ngx-mat-select-search>
                                            </mat-option>
                                            <mat-option *ngFor="
                          let CE of classTypeOfReason
                            | filterSelectInput: typeOfReasonCtrl.value
                        " [value]="CE.value" matTooltip="{{ CE.viewValue }}">
                                                {{ CE.viewValue }}
                                            </mat-option>
                                        </mat-select>
                                        <div class="error-wrapper"
                                            *ngIf=" inwardDialogFormGroup.controls.reason.touched &&inwardDialogFormGroup.controls.reason.errors">
                                            <mat-error *ngIf="inwardDialogFormGroup.controls.reason.errors.required">
                                                {{ errorMessage.REASON }}
                                            </mat-error>
                                        </div>

                                    </mat-form-field>
                                </div>

                                <div class="col-sm-6 col-md-3">
                                    <mat-form-field>
                                        <mat-label>Account Close Date</mat-label>
                                        <input matInput [matDatepicker]="letterDatePicker1"
                                            formControlName="accountCloseDate" dateOnly />
                                        <mat-datepicker-toggle matSuffix [for]="letterDatePicker1">
                                        </mat-datepicker-toggle>
                                        <mat-datepicker #letterDatePicker1></mat-datepicker>

                                    </mat-form-field>
                                </div>





                                <div class="col-sm-6 col-md-3">
                                    <mat-form-field>
                                        <mat-label>Reason Date</mat-label>
                                        <input matInput [matDatepicker]="letterDatePicker2" required
                                            formControlName="reasonDate" dateOnly />
                                        <mat-datepicker-toggle matSuffix [for]="letterDatePicker2">
                                        </mat-datepicker-toggle>
                                        <mat-datepicker #letterDatePicker2></mat-datepicker>
                                        <div class="error-wrapper"
                                            *ngIf=" inwardDialogFormGroup.controls.reasonDate.touched &&inwardDialogFormGroup.controls.reasonDate.errors">
                                            <mat-error
                                                *ngIf="inwardDialogFormGroup.controls.reasonDate.errors.required">
                                                {{ errorMessage.REASON_DATE }}
                                            </mat-error>
                                        </div>



                                    </mat-form-field>
                                </div>

                                <div class="col-sm-6 col-md-3">
                                    <mat-form-field class="full-width">
                                        <textarea matInput placeholder="Noting" formControlName='noting'></textarea>
                                    </mat-form-field>
                                </div>









                            </div>
                        </div>


                    </div>


                </form>
                <div class="form-action-button">

                    <button mat-raised-button type="submit" class="green" title="Submit" (click)="workflowDetails()">
                        <i class="material-icons" title="Submit" aria-hidden="true">done</i>
                        Submit
                    </button>


                    <button type="button" mat-raised-button class="btnClose" title="Close">
                        <i class="material-icons" title="Close" aria-hidden="true">
                            close
                        </i>
                        Close
                    </button>

                </div>
            </mat-tab>


            <mat-tab label="Attachment">
                <table mat-table [dataSource]="dataSourceBrowse" width="100%" id="browseTable" *ngIf="DDO">
                    <ng-container matColumnDef="sr_no">
                        <th mat-header-cell *matHeaderCellDef scope="row">
                            <b>Sr. No.</b>
                        </th>
                        <td mat-cell *matCellDef="let item; let i = index" class="rightAllign">
                            {{ i + 1 }}
                        </td>
                    </ng-container>
                    <ng-container matColumnDef="attachmentType">
                        <th mat-header-cell *matHeaderCellDef scope="row">Attachment Type</th>
                        <td class="attechmentData" mat-cell *matCellDef="let item;let i=index">
                            {{item.attachment}}
                            <span *ngIf="i < 6" class="starSign">*</span>
                        </td>
                    </ng-container>
                    <ng-container matColumnDef="fileName">
                        <th mat-header-cell *matHeaderCellDef scope="row">File Name</th>
                        <td mat-cell *matCellDef="let item">
                            <mat-form-field floatLabel="never">
                                <input matInput [value]="item.name" [(ngModel)]="item.name">
                            </mat-form-field>
                        </td>
                    </ng-container>
                    <ng-container matColumnDef="browse">
                        <th mat-header-cell *matHeaderCellDef scope="row">Browse File</th>
                        <td mat-cell *matCellDef="let i = index">
                            <button type="button" (click)="openFileSelector(i)" class="btn-browse">
                                Browse Files
                            </button>
                        </td>
                    </ng-container>
                    <ng-container matColumnDef="uploadedFileName">
                        <th mat-header-cell *matHeaderCellDef scope="row">Uploaded File Name</th>
                        <td mat-cell *matCellDef="let item">
                            <span *ngIf="item.file && item.file.name">{{item.file.name}}
                                <i class="material-icons closesmall">close</i>
                            </span>
                        </td>
                    </ng-container>
                    <ng-container matColumnDef="uploadedBy">
                        <th mat-header-cell *matHeaderCellDef scope="row">Uploaded By</th>
                        <td mat-cell *matCellDef="let item">
                            <mat-label>Mr. Pratik Shah</mat-label>
                        </td>
                    </ng-container>
                    <ng-container matColumnDef="action">
                        <th mat-header-cell *matHeaderCellDef scope="row">Action</th>
                        <td mat-cell *matCellDef="let item; let i = index">
                            <table class="iconTable">
                                <tbody>
                                    <tr>
                                        <td class="action-btn-i centerAlign">
                                            <a>
                                                <i class="material-icons plus add" title="Add"
                                                    *ngIf="dataSourceBrowse && dataSourceBrowse.data && (i == dataSourceBrowse.data.length - 1)"
                                                    (click)="addBrowse()" aria-hidden="true">add
                                                </i>
                                            </a>
                                            <a>
                                                <i class="material-icons plus view-icon" title="View"
                                                    aria-hidden="true">remove_red_eye
                                                </i>
                                            </a>
                                            <a>
                                                <i class="material-icons plus delete"
                                                    *ngIf="dataSourceBrowse && dataSourceBrowse.data && i > 6"
                                                    (click)="deleteBrowse(i)" aria-hidden="true">delete
                                                </i>
                                            </a>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </td>
                    </ng-container>
                    <!-- Header Section Of table -->
                    <tr mat-header-row *matHeaderRowDef="displayedBrowseColumns"></tr>
                    <!-- Data Fetch From .TS File to table -->
                    <tr mat-row *matRowDef="let row; columns: displayedBrowseColumns;"></tr>
                </table>
                <table mat-table [dataSource]="nonDdoDataSourceBrowse" width="100%" id="browseTable" *ngIf="isNonDDO">
                    <ng-container matColumnDef="sr_no">
                        <th mat-header-cell *matHeaderCellDef scope="row">
                            <b>Sr. No.</b>
                        </th>
                        <td mat-cell *matCellDef="let item; let i = index" class="rightAllign">
                            {{ i + 1 }}
                        </td>
                    </ng-container>
                    <ng-container matColumnDef="attachmentType">
                        <th mat-header-cell *matHeaderCellDef scope="row">Attachment Type</th>
                        <td class="attechmentData" mat-cell *matCellDef="let item;let i=index">
                            {{item.attachment}}
                        </td>
                    </ng-container>
                    <ng-container matColumnDef="fileName">
                        <th mat-header-cell *matHeaderCellDef scope="row">File Name</th>
                        <td mat-cell *matCellDef="let item">
                            <mat-form-field floatLabel="never">
                                <input matInput [value]="item.name" [(ngModel)]="item.name">
                            </mat-form-field>
                        </td>
                    </ng-container>
                    <ng-container matColumnDef="browse">
                        <th mat-header-cell *matHeaderCellDef scope="row">Browse File</th>
                        <td mat-cell *matCellDef="let i = index">
                            <button type="button" (click)="openFileSelector(i)" class="btn-browse">
                                Browse Files
                            </button>
                        </td>
                    </ng-container>
                    <ng-container matColumnDef="uploadedFileName">
                        <th mat-header-cell *matHeaderCellDef scope="row">Uploaded File Name</th>
                        <td mat-cell *matCellDef="let item">
                            <span *ngIf="item.file && item.file.name">{{item.file.name}}
                                <i class="material-icons closesmall">close</i>
                            </span>
                        </td>
                    </ng-container>
                    <ng-container matColumnDef="uploadedBy">
                        <th mat-header-cell *matHeaderCellDef scope="row">Uploaded By</th>
                        <td mat-cell *matCellDef="let item">
                            <mat-label>Mr. Pratik Shah</mat-label>
                        </td>
                    </ng-container>
                    <ng-container matColumnDef="action">
                        <th mat-header-cell *matHeaderCellDef scope="row">Action</th>
                        <td mat-cell *matCellDef="let item; let i = index">
                            <table class="iconTable">
                                <tbody>
                                    <tr>
                                        <td class="action-btn-i centerAlign">
                                            <a>
                                                <i class="material-icons plus add" title="Add"
                                                    *ngIf="dataSourceBrowse && dataSourceBrowse.data && (i == dataSourceBrowse.data.length - 1)"
                                                    (click)="addBrowse()" aria-hidden="true">add
                                                </i>
                                            </a>
                                            <a>
                                                <i class="material-icons plus view-icon" title="View"
                                                    aria-hidden="true">remove_red_eye
                                                </i>
                                            </a>
                                            <a>
                                                <i class="material-icons plus delete"
                                                    *ngIf="dataSourceBrowse && dataSourceBrowse.data && i > 6"
                                                    (click)="deleteBrowse(i)" aria-hidden="true">delete
                                                </i>
                                            </a>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </td>
                    </ng-container>
                    <!-- Header Section Of table -->
                    <tr mat-header-row *matHeaderRowDef="displayedBrowseColumns"></tr>
                    <!-- Data Fetch From .TS File to table -->
                    <tr mat-row *matRowDef="let row; columns: displayedBrowseColumns;"></tr>
                </table>
                <input type="file" id="fileBrowse" class="fileBrowse" (change)="onFileSelection($event)" />
                <div class="legend">
                    1. Total File size should be under 4MB<br> 2. File type supported are: 'jpg', 'jpeg', 'png', 'pdf',
                    JPG’, ‘JPEG’, ‘PNG’, ‘PDF’.
                </div>
                <!-- Action Button -->
                <div class="form-action-button">
                    <button type="submit" mat-raised-button color="primary">
                        <i class="material-icons" title="Save" aria-hidden="true">cloud_upload</i>
                        Upload
                    </button>
                    <button mat-raised-button type="submit" class="green">
                        <i class="material-icons" aria-hidden="true">done</i>
                        Submit
                    </button>
                    <button type="reset" mat-raised-button color="accent">
                        <i class="material-icons" aria-hidden="true">restore</i>
                        Reset
                    </button>
                    <button type="button" mat-raised-button color="warn">
                        <i class="material-icons" title="Listing" aria-hidden="true">list</i>
                        Listing
                    </button>
                    <button type="button" mat-raised-button class="btnClose">
                        <i class="material-icons" title="Budget dashboard" aria-hidden="true">close</i>
                        Close
                    </button>
                </div>
                <!-- End Action Button -->
            </mat-tab>
        </mat-tab-group>
        <!-- End Online Final Payment Case -DPPF -->


    </div>
</div>